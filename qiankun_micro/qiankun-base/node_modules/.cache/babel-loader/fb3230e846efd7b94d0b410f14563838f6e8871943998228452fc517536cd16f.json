{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\n/**\n * @author Kuitos\n * @homepage https://github.com/kuitos/\n * @since 2018-08-15 11:37\n */\n\nimport processTpl, { genLinkReplaceSymbol, genScriptReplaceSymbol } from './process-tpl';\nimport { defaultGetPublicPath, evalCode, getGlobalProp, getInlineCode, noteGlobalProps, readResAsString, requestIdleCallback } from './utils';\nvar styleCache = {};\nvar scriptCache = {};\nvar embedHTMLCache = {};\nif (!window.fetch) {\n  throw new Error('[import-html-entry] Here is no \"fetch\" on the window env, you need to polyfill it');\n}\nvar defaultFetch = window.fetch.bind(window);\nfunction defaultGetTemplate(tpl) {\n  return tpl;\n}\n\n/**\n * convert external css link to inline style for performance optimization\n * @param template\n * @param styles\n * @param opts\n * @return embedHTML\n */\nfunction getEmbedHTML(template, styles) {\n  var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var _opts$fetch = opts.fetch,\n    fetch = _opts$fetch === void 0 ? defaultFetch : _opts$fetch;\n  var embedHTML = template;\n  return _getExternalStyleSheets(styles, fetch).then(function (styleSheets) {\n    embedHTML = styles.reduce(function (html, styleSrc, i) {\n      html = html.replace(genLinkReplaceSymbol(styleSrc), isInlineCode(styleSrc) ? \"\".concat(styleSrc) : \"<style>/* \".concat(styleSrc, \" */\").concat(styleSheets[i], \"</style>\"));\n      return html;\n    }, embedHTML);\n    return embedHTML;\n  });\n}\nvar isInlineCode = function isInlineCode(code) {\n  return code.startsWith('<');\n};\nfunction getExecutableScript(scriptSrc, scriptText) {\n  var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var proxy = opts.proxy,\n    strictGlobal = opts.strictGlobal,\n    _opts$scopedGlobalVar = opts.scopedGlobalVariables,\n    scopedGlobalVariables = _opts$scopedGlobalVar === void 0 ? [] : _opts$scopedGlobalVar;\n  var sourceUrl = isInlineCode(scriptSrc) ? '' : \"//# sourceURL=\".concat(scriptSrc, \"\\n\");\n\n  // 将 scopedGlobalVariables 拼接成变量声明，用于缓存全局变量，避免每次使用时都走一遍代理\n  var scopedGlobalVariableDefinition = scopedGlobalVariables.length ? \"const {\".concat(scopedGlobalVariables.join(','), \"}=this;\") : '';\n\n  // 通过这种方式获取全局 window，因为 script 也是在全局作用域下运行的，所以我们通过 window.proxy 绑定时也必须确保绑定到全局 window 上\n  // 否则在嵌套场景下， window.proxy 设置的是内层应用的 window，而代码其实是在全局作用域运行的，会导致闭包里的 window.proxy 取的是最外层的微应用的 proxy\n  var globalWindow = (0, eval)('window');\n  globalWindow.proxy = proxy;\n  // TODO 通过 strictGlobal 方式切换 with 闭包，待 with 方式坑趟平后再合并\n  return strictGlobal ? scopedGlobalVariableDefinition ? \";(function(){with(this){\".concat(scopedGlobalVariableDefinition).concat(scriptText, \"\\n\").concat(sourceUrl, \"}}).bind(window.proxy)();\") : \";(function(window, self, globalThis){with(window){;\".concat(scriptText, \"\\n\").concat(sourceUrl, \"}}).bind(window.proxy)(window.proxy, window.proxy, window.proxy);\") : \";(function(window, self, globalThis){;\".concat(scriptText, \"\\n\").concat(sourceUrl, \"}).bind(window.proxy)(window.proxy, window.proxy, window.proxy);\");\n}\n\n// for prefetch\nfunction _getExternalStyleSheets(styles) {\n  var fetch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultFetch;\n  return Promise.all(styles.map(function (styleLink) {\n    if (isInlineCode(styleLink)) {\n      // if it is inline style\n      return getInlineCode(styleLink);\n    } else {\n      // external styles\n      return styleCache[styleLink] || (styleCache[styleLink] = fetch(styleLink).then(function (response) {\n        return response.text();\n      }));\n    }\n  }));\n}\n\n// for prefetch\nexport { _getExternalStyleSheets as getExternalStyleSheets };\nfunction _getExternalScripts(scripts) {\n  var fetch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultFetch;\n  var fetchScript = function fetchScript(scriptUrl, opts) {\n    return scriptCache[scriptUrl] || (scriptCache[scriptUrl] = fetch(scriptUrl, opts).then(function (response) {\n      // usually browser treats 4xx and 5xx response of script loading as an error and will fire a script error event\n      // https://stackoverflow.com/questions/5625420/what-http-headers-responses-trigger-the-onerror-handler-on-a-script-tag/5625603\n      if (response.status >= 400) {\n        throw new Error(\"\".concat(scriptUrl, \" load failed with status \").concat(response.status));\n      }\n      return response.text();\n    }));\n  };\n  return Promise.all(scripts.map(function (script) {\n    if (typeof script === 'string') {\n      if (isInlineCode(script)) {\n        // if it is inline script\n        return getInlineCode(script);\n      } else {\n        // external script\n        return fetchScript(script);\n      }\n    } else {\n      // use idle time to load async script\n      var src = script.src,\n        async = script.async,\n        crossOrigin = script.crossOrigin;\n      var fetchOpts = crossOrigin ? {\n        credentials: 'include'\n      } : {};\n      if (async) {\n        return {\n          src: src,\n          async: true,\n          content: new Promise(function (resolve, reject) {\n            return requestIdleCallback(function () {\n              return fetchScript(src, fetchOpts).then(resolve, reject);\n            });\n          })\n        };\n      }\n      return fetchScript(src, fetchOpts);\n    }\n  }));\n}\nexport { _getExternalScripts as getExternalScripts };\nfunction throwNonBlockingError(error, msg) {\n  setTimeout(function () {\n    console.error(msg);\n    throw error;\n  });\n}\nvar supportsUserTiming = typeof performance !== 'undefined' && typeof performance.mark === 'function' && typeof performance.clearMarks === 'function' && typeof performance.measure === 'function' && typeof performance.clearMeasures === 'function';\n\n/**\n * FIXME to consistent with browser behavior, we should only provide callback way to invoke success and error event\n * @param entry\n * @param scripts\n * @param proxy\n * @param opts\n * @returns {Promise<unknown>}\n */\nfunction _execScripts(entry, scripts) {\n  var proxy = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : window;\n  var opts = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  var _opts$fetch2 = opts.fetch,\n    fetch = _opts$fetch2 === void 0 ? defaultFetch : _opts$fetch2,\n    _opts$strictGlobal = opts.strictGlobal,\n    strictGlobal = _opts$strictGlobal === void 0 ? false : _opts$strictGlobal,\n    success = opts.success,\n    _opts$error = opts.error,\n    error = _opts$error === void 0 ? function () {} : _opts$error,\n    _opts$beforeExec = opts.beforeExec,\n    beforeExec = _opts$beforeExec === void 0 ? function () {} : _opts$beforeExec,\n    _opts$afterExec = opts.afterExec,\n    afterExec = _opts$afterExec === void 0 ? function () {} : _opts$afterExec,\n    _opts$scopedGlobalVar2 = opts.scopedGlobalVariables,\n    scopedGlobalVariables = _opts$scopedGlobalVar2 === void 0 ? [] : _opts$scopedGlobalVar2;\n  return _getExternalScripts(scripts, fetch).then(function (scriptsText) {\n    var geval = function geval(scriptSrc, inlineScript) {\n      var rawCode = beforeExec(inlineScript, scriptSrc) || inlineScript;\n      var code = getExecutableScript(scriptSrc, rawCode, {\n        proxy: proxy,\n        strictGlobal: strictGlobal,\n        scopedGlobalVariables: scopedGlobalVariables\n      });\n      evalCode(scriptSrc, code);\n      afterExec(inlineScript, scriptSrc);\n    };\n    function exec(scriptSrc, inlineScript, resolve) {\n      var markName = \"Evaluating script \".concat(scriptSrc);\n      var measureName = \"Evaluating Time Consuming: \".concat(scriptSrc);\n      if (process.env.NODE_ENV === 'development' && supportsUserTiming) {\n        performance.mark(markName);\n      }\n      if (scriptSrc === entry) {\n        noteGlobalProps(strictGlobal ? proxy : window);\n        try {\n          geval(scriptSrc, inlineScript);\n          var exports = proxy[getGlobalProp(strictGlobal ? proxy : window)] || {};\n          resolve(exports);\n        } catch (e) {\n          // entry error must be thrown to make the promise settled\n          console.error(\"[import-html-entry]: error occurs while executing entry script \".concat(scriptSrc));\n          throw e;\n        }\n      } else {\n        if (typeof inlineScript === 'string') {\n          try {\n            if (scriptSrc !== null && scriptSrc !== void 0 && scriptSrc.src) {\n              geval(scriptSrc.src, inlineScript);\n            } else {\n              geval(scriptSrc, inlineScript);\n            }\n          } catch (e) {\n            // consistent with browser behavior, any independent script evaluation error should not block the others\n            throwNonBlockingError(e, \"[import-html-entry]: error occurs while executing normal script \".concat(scriptSrc));\n          }\n        } else {\n          // external script marked with async\n          inlineScript.async && (inlineScript === null || inlineScript === void 0 ? void 0 : inlineScript.content.then(function (downloadedScriptText) {\n            return geval(inlineScript.src, downloadedScriptText);\n          })[\"catch\"](function (e) {\n            throwNonBlockingError(e, \"[import-html-entry]: error occurs while executing async script \".concat(inlineScript.src));\n          }));\n        }\n      }\n      if (process.env.NODE_ENV === 'development' && supportsUserTiming) {\n        performance.measure(measureName, markName);\n        performance.clearMarks(markName);\n        performance.clearMeasures(measureName);\n      }\n    }\n    function schedule(i, resolvePromise) {\n      if (i < scripts.length) {\n        var scriptSrc = scripts[i];\n        var inlineScript = scriptsText[i];\n        exec(scriptSrc, inlineScript, resolvePromise);\n        // resolve the promise while the last script executed and entry not provided\n        if (!entry && i === scripts.length - 1) {\n          resolvePromise();\n        } else {\n          schedule(i + 1, resolvePromise);\n        }\n      }\n    }\n    return new Promise(function (resolve) {\n      return schedule(0, success || resolve);\n    });\n  })[\"catch\"](function (e) {\n    error();\n    throw e;\n  });\n}\nexport { _execScripts as execScripts };\nexport default function importHTML(url) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var fetch = defaultFetch;\n  var autoDecodeResponse = false;\n  var getPublicPath = defaultGetPublicPath;\n  var getTemplate = defaultGetTemplate;\n  var postProcessTemplate = opts.postProcessTemplate;\n\n  // compatible with the legacy importHTML api\n  if (typeof opts === 'function') {\n    fetch = opts;\n  } else {\n    // fetch option is availble\n    if (opts.fetch) {\n      // fetch is a funciton\n      if (typeof opts.fetch === 'function') {\n        fetch = opts.fetch;\n      } else {\n        // configuration\n        fetch = opts.fetch.fn || defaultFetch;\n        autoDecodeResponse = !!opts.fetch.autoDecodeResponse;\n      }\n    }\n    getPublicPath = opts.getPublicPath || opts.getDomain || defaultGetPublicPath;\n    getTemplate = opts.getTemplate || defaultGetTemplate;\n  }\n  return embedHTMLCache[url] || (embedHTMLCache[url] = fetch(url).then(function (response) {\n    return readResAsString(response, autoDecodeResponse);\n  }).then(function (html) {\n    var assetPublicPath = getPublicPath(url);\n    var _processTpl = processTpl(getTemplate(html), assetPublicPath, postProcessTemplate),\n      template = _processTpl.template,\n      scripts = _processTpl.scripts,\n      entry = _processTpl.entry,\n      styles = _processTpl.styles;\n    return getEmbedHTML(template, styles, {\n      fetch: fetch\n    }).then(function (embedHTML) {\n      return {\n        template: embedHTML,\n        assetPublicPath: assetPublicPath,\n        getExternalScripts: function getExternalScripts() {\n          return _getExternalScripts(scripts, fetch);\n        },\n        getExternalStyleSheets: function getExternalStyleSheets() {\n          return _getExternalStyleSheets(styles, fetch);\n        },\n        execScripts: function execScripts(proxy, strictGlobal) {\n          var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n          if (!scripts.length) {\n            return Promise.resolve();\n          }\n          return _execScripts(entry, scripts, proxy, _objectSpread({\n            fetch: fetch,\n            strictGlobal: strictGlobal\n          }, opts));\n        }\n      };\n    });\n  }));\n}\nexport function importEntry(entry) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var _opts$fetch3 = opts.fetch,\n    fetch = _opts$fetch3 === void 0 ? defaultFetch : _opts$fetch3,\n    _opts$getTemplate = opts.getTemplate,\n    getTemplate = _opts$getTemplate === void 0 ? defaultGetTemplate : _opts$getTemplate,\n    postProcessTemplate = opts.postProcessTemplate;\n  var getPublicPath = opts.getPublicPath || opts.getDomain || defaultGetPublicPath;\n  if (!entry) {\n    throw new SyntaxError('entry should not be empty!');\n  }\n\n  // html entry\n  if (typeof entry === 'string') {\n    return importHTML(entry, {\n      fetch: fetch,\n      getPublicPath: getPublicPath,\n      getTemplate: getTemplate,\n      postProcessTemplate: postProcessTemplate\n    });\n  }\n\n  // config entry\n  if (Array.isArray(entry.scripts) || Array.isArray(entry.styles)) {\n    var _entry$scripts = entry.scripts,\n      scripts = _entry$scripts === void 0 ? [] : _entry$scripts,\n      _entry$styles = entry.styles,\n      styles = _entry$styles === void 0 ? [] : _entry$styles,\n      _entry$html = entry.html,\n      html = _entry$html === void 0 ? '' : _entry$html;\n    var getHTMLWithStylePlaceholder = function getHTMLWithStylePlaceholder(tpl) {\n      return styles.reduceRight(function (html, styleSrc) {\n        return \"\".concat(genLinkReplaceSymbol(styleSrc)).concat(html);\n      }, tpl);\n    };\n    var getHTMLWithScriptPlaceholder = function getHTMLWithScriptPlaceholder(tpl) {\n      return scripts.reduce(function (html, scriptSrc) {\n        return \"\".concat(html).concat(genScriptReplaceSymbol(scriptSrc));\n      }, tpl);\n    };\n    return getEmbedHTML(getTemplate(getHTMLWithScriptPlaceholder(getHTMLWithStylePlaceholder(html))), styles, {\n      fetch: fetch\n    }).then(function (embedHTML) {\n      return {\n        template: embedHTML,\n        assetPublicPath: getPublicPath(entry),\n        getExternalScripts: function getExternalScripts() {\n          return _getExternalScripts(scripts, fetch);\n        },\n        getExternalStyleSheets: function getExternalStyleSheets() {\n          return _getExternalStyleSheets(styles, fetch);\n        },\n        execScripts: function execScripts(proxy, strictGlobal) {\n          var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n          if (!scripts.length) {\n            return Promise.resolve();\n          }\n          return _execScripts(scripts[scripts.length - 1], scripts, proxy, _objectSpread({\n            fetch: fetch,\n            strictGlobal: strictGlobal\n          }, opts));\n        }\n      };\n    });\n  } else {\n    throw new SyntaxError('entry scripts or styles should be array!');\n  }\n}","map":{"version":3,"names":["_defineProperty","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","processTpl","genLinkReplaceSymbol","genScriptReplaceSymbol","defaultGetPublicPath","evalCode","getGlobalProp","getInlineCode","noteGlobalProps","readResAsString","requestIdleCallback","styleCache","scriptCache","embedHTMLCache","window","fetch","Error","defaultFetch","bind","defaultGetTemplate","tpl","getEmbedHTML","template","styles","opts","undefined","_opts$fetch","embedHTML","_getExternalStyleSheets","then","styleSheets","reduce","html","styleSrc","replace","isInlineCode","concat","code","startsWith","getExecutableScript","scriptSrc","scriptText","proxy","strictGlobal","_opts$scopedGlobalVar","scopedGlobalVariables","sourceUrl","scopedGlobalVariableDefinition","join","globalWindow","eval","Promise","all","map","styleLink","response","text","getExternalStyleSheets","_getExternalScripts","scripts","fetchScript","scriptUrl","status","script","src","async","crossOrigin","fetchOpts","credentials","content","resolve","reject","getExternalScripts","throwNonBlockingError","error","msg","setTimeout","console","supportsUserTiming","performance","mark","clearMarks","measure","clearMeasures","_execScripts","entry","_opts$fetch2","_opts$strictGlobal","success","_opts$error","_opts$beforeExec","beforeExec","_opts$afterExec","afterExec","_opts$scopedGlobalVar2","scriptsText","geval","inlineScript","rawCode","exec","markName","measureName","process","env","NODE_ENV","exports","e","downloadedScriptText","schedule","resolvePromise","execScripts","importHTML","url","autoDecodeResponse","getPublicPath","getTemplate","postProcessTemplate","fn","getDomain","assetPublicPath","_processTpl","importEntry","_opts$fetch3","_opts$getTemplate","SyntaxError","Array","isArray","_entry$scripts","_entry$styles","_entry$html","getHTMLWithStylePlaceholder","reduceRight","getHTMLWithScriptPlaceholder"],"sources":["/home/lishu/桌面/Micro_frontend_practice/qiankun_micro/qiankun-base/node_modules/import-html-entry/esm/index.js"],"sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n/**\n * @author Kuitos\n * @homepage https://github.com/kuitos/\n * @since 2018-08-15 11:37\n */\n\nimport processTpl, { genLinkReplaceSymbol, genScriptReplaceSymbol } from './process-tpl';\nimport { defaultGetPublicPath, evalCode, getGlobalProp, getInlineCode, noteGlobalProps, readResAsString, requestIdleCallback } from './utils';\nvar styleCache = {};\nvar scriptCache = {};\nvar embedHTMLCache = {};\nif (!window.fetch) {\n  throw new Error('[import-html-entry] Here is no \"fetch\" on the window env, you need to polyfill it');\n}\nvar defaultFetch = window.fetch.bind(window);\nfunction defaultGetTemplate(tpl) {\n  return tpl;\n}\n\n/**\n * convert external css link to inline style for performance optimization\n * @param template\n * @param styles\n * @param opts\n * @return embedHTML\n */\nfunction getEmbedHTML(template, styles) {\n  var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var _opts$fetch = opts.fetch,\n    fetch = _opts$fetch === void 0 ? defaultFetch : _opts$fetch;\n  var embedHTML = template;\n  return _getExternalStyleSheets(styles, fetch).then(function (styleSheets) {\n    embedHTML = styles.reduce(function (html, styleSrc, i) {\n      html = html.replace(genLinkReplaceSymbol(styleSrc), isInlineCode(styleSrc) ? \"\".concat(styleSrc) : \"<style>/* \".concat(styleSrc, \" */\").concat(styleSheets[i], \"</style>\"));\n      return html;\n    }, embedHTML);\n    return embedHTML;\n  });\n}\nvar isInlineCode = function isInlineCode(code) {\n  return code.startsWith('<');\n};\nfunction getExecutableScript(scriptSrc, scriptText) {\n  var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var proxy = opts.proxy,\n    strictGlobal = opts.strictGlobal,\n    _opts$scopedGlobalVar = opts.scopedGlobalVariables,\n    scopedGlobalVariables = _opts$scopedGlobalVar === void 0 ? [] : _opts$scopedGlobalVar;\n  var sourceUrl = isInlineCode(scriptSrc) ? '' : \"//# sourceURL=\".concat(scriptSrc, \"\\n\");\n\n  // 将 scopedGlobalVariables 拼接成变量声明，用于缓存全局变量，避免每次使用时都走一遍代理\n  var scopedGlobalVariableDefinition = scopedGlobalVariables.length ? \"const {\".concat(scopedGlobalVariables.join(','), \"}=this;\") : '';\n\n  // 通过这种方式获取全局 window，因为 script 也是在全局作用域下运行的，所以我们通过 window.proxy 绑定时也必须确保绑定到全局 window 上\n  // 否则在嵌套场景下， window.proxy 设置的是内层应用的 window，而代码其实是在全局作用域运行的，会导致闭包里的 window.proxy 取的是最外层的微应用的 proxy\n  var globalWindow = (0, eval)('window');\n  globalWindow.proxy = proxy;\n  // TODO 通过 strictGlobal 方式切换 with 闭包，待 with 方式坑趟平后再合并\n  return strictGlobal ? scopedGlobalVariableDefinition ? \";(function(){with(this){\".concat(scopedGlobalVariableDefinition).concat(scriptText, \"\\n\").concat(sourceUrl, \"}}).bind(window.proxy)();\") : \";(function(window, self, globalThis){with(window){;\".concat(scriptText, \"\\n\").concat(sourceUrl, \"}}).bind(window.proxy)(window.proxy, window.proxy, window.proxy);\") : \";(function(window, self, globalThis){;\".concat(scriptText, \"\\n\").concat(sourceUrl, \"}).bind(window.proxy)(window.proxy, window.proxy, window.proxy);\");\n}\n\n// for prefetch\nfunction _getExternalStyleSheets(styles) {\n  var fetch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultFetch;\n  return Promise.all(styles.map(function (styleLink) {\n    if (isInlineCode(styleLink)) {\n      // if it is inline style\n      return getInlineCode(styleLink);\n    } else {\n      // external styles\n      return styleCache[styleLink] || (styleCache[styleLink] = fetch(styleLink).then(function (response) {\n        return response.text();\n      }));\n    }\n  }));\n}\n\n// for prefetch\nexport { _getExternalStyleSheets as getExternalStyleSheets };\nfunction _getExternalScripts(scripts) {\n  var fetch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultFetch;\n  var fetchScript = function fetchScript(scriptUrl, opts) {\n    return scriptCache[scriptUrl] || (scriptCache[scriptUrl] = fetch(scriptUrl, opts).then(function (response) {\n      // usually browser treats 4xx and 5xx response of script loading as an error and will fire a script error event\n      // https://stackoverflow.com/questions/5625420/what-http-headers-responses-trigger-the-onerror-handler-on-a-script-tag/5625603\n      if (response.status >= 400) {\n        throw new Error(\"\".concat(scriptUrl, \" load failed with status \").concat(response.status));\n      }\n      return response.text();\n    }));\n  };\n  return Promise.all(scripts.map(function (script) {\n    if (typeof script === 'string') {\n      if (isInlineCode(script)) {\n        // if it is inline script\n        return getInlineCode(script);\n      } else {\n        // external script\n        return fetchScript(script);\n      }\n    } else {\n      // use idle time to load async script\n      var src = script.src,\n        async = script.async,\n        crossOrigin = script.crossOrigin;\n      var fetchOpts = crossOrigin ? {\n        credentials: 'include'\n      } : {};\n      if (async) {\n        return {\n          src: src,\n          async: true,\n          content: new Promise(function (resolve, reject) {\n            return requestIdleCallback(function () {\n              return fetchScript(src, fetchOpts).then(resolve, reject);\n            });\n          })\n        };\n      }\n      return fetchScript(src, fetchOpts);\n    }\n  }));\n}\nexport { _getExternalScripts as getExternalScripts };\nfunction throwNonBlockingError(error, msg) {\n  setTimeout(function () {\n    console.error(msg);\n    throw error;\n  });\n}\nvar supportsUserTiming = typeof performance !== 'undefined' && typeof performance.mark === 'function' && typeof performance.clearMarks === 'function' && typeof performance.measure === 'function' && typeof performance.clearMeasures === 'function';\n\n/**\n * FIXME to consistent with browser behavior, we should only provide callback way to invoke success and error event\n * @param entry\n * @param scripts\n * @param proxy\n * @param opts\n * @returns {Promise<unknown>}\n */\nfunction _execScripts(entry, scripts) {\n  var proxy = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : window;\n  var opts = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  var _opts$fetch2 = opts.fetch,\n    fetch = _opts$fetch2 === void 0 ? defaultFetch : _opts$fetch2,\n    _opts$strictGlobal = opts.strictGlobal,\n    strictGlobal = _opts$strictGlobal === void 0 ? false : _opts$strictGlobal,\n    success = opts.success,\n    _opts$error = opts.error,\n    error = _opts$error === void 0 ? function () {} : _opts$error,\n    _opts$beforeExec = opts.beforeExec,\n    beforeExec = _opts$beforeExec === void 0 ? function () {} : _opts$beforeExec,\n    _opts$afterExec = opts.afterExec,\n    afterExec = _opts$afterExec === void 0 ? function () {} : _opts$afterExec,\n    _opts$scopedGlobalVar2 = opts.scopedGlobalVariables,\n    scopedGlobalVariables = _opts$scopedGlobalVar2 === void 0 ? [] : _opts$scopedGlobalVar2;\n  return _getExternalScripts(scripts, fetch).then(function (scriptsText) {\n    var geval = function geval(scriptSrc, inlineScript) {\n      var rawCode = beforeExec(inlineScript, scriptSrc) || inlineScript;\n      var code = getExecutableScript(scriptSrc, rawCode, {\n        proxy: proxy,\n        strictGlobal: strictGlobal,\n        scopedGlobalVariables: scopedGlobalVariables\n      });\n      evalCode(scriptSrc, code);\n      afterExec(inlineScript, scriptSrc);\n    };\n    function exec(scriptSrc, inlineScript, resolve) {\n      var markName = \"Evaluating script \".concat(scriptSrc);\n      var measureName = \"Evaluating Time Consuming: \".concat(scriptSrc);\n      if (process.env.NODE_ENV === 'development' && supportsUserTiming) {\n        performance.mark(markName);\n      }\n      if (scriptSrc === entry) {\n        noteGlobalProps(strictGlobal ? proxy : window);\n        try {\n          geval(scriptSrc, inlineScript);\n          var exports = proxy[getGlobalProp(strictGlobal ? proxy : window)] || {};\n          resolve(exports);\n        } catch (e) {\n          // entry error must be thrown to make the promise settled\n          console.error(\"[import-html-entry]: error occurs while executing entry script \".concat(scriptSrc));\n          throw e;\n        }\n      } else {\n        if (typeof inlineScript === 'string') {\n          try {\n            if (scriptSrc !== null && scriptSrc !== void 0 && scriptSrc.src) {\n              geval(scriptSrc.src, inlineScript);\n            } else {\n              geval(scriptSrc, inlineScript);\n            }\n          } catch (e) {\n            // consistent with browser behavior, any independent script evaluation error should not block the others\n            throwNonBlockingError(e, \"[import-html-entry]: error occurs while executing normal script \".concat(scriptSrc));\n          }\n        } else {\n          // external script marked with async\n          inlineScript.async && (inlineScript === null || inlineScript === void 0 ? void 0 : inlineScript.content.then(function (downloadedScriptText) {\n            return geval(inlineScript.src, downloadedScriptText);\n          })[\"catch\"](function (e) {\n            throwNonBlockingError(e, \"[import-html-entry]: error occurs while executing async script \".concat(inlineScript.src));\n          }));\n        }\n      }\n      if (process.env.NODE_ENV === 'development' && supportsUserTiming) {\n        performance.measure(measureName, markName);\n        performance.clearMarks(markName);\n        performance.clearMeasures(measureName);\n      }\n    }\n    function schedule(i, resolvePromise) {\n      if (i < scripts.length) {\n        var scriptSrc = scripts[i];\n        var inlineScript = scriptsText[i];\n        exec(scriptSrc, inlineScript, resolvePromise);\n        // resolve the promise while the last script executed and entry not provided\n        if (!entry && i === scripts.length - 1) {\n          resolvePromise();\n        } else {\n          schedule(i + 1, resolvePromise);\n        }\n      }\n    }\n    return new Promise(function (resolve) {\n      return schedule(0, success || resolve);\n    });\n  })[\"catch\"](function (e) {\n    error();\n    throw e;\n  });\n}\nexport { _execScripts as execScripts };\nexport default function importHTML(url) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var fetch = defaultFetch;\n  var autoDecodeResponse = false;\n  var getPublicPath = defaultGetPublicPath;\n  var getTemplate = defaultGetTemplate;\n  var postProcessTemplate = opts.postProcessTemplate;\n\n  // compatible with the legacy importHTML api\n  if (typeof opts === 'function') {\n    fetch = opts;\n  } else {\n    // fetch option is availble\n    if (opts.fetch) {\n      // fetch is a funciton\n      if (typeof opts.fetch === 'function') {\n        fetch = opts.fetch;\n      } else {\n        // configuration\n        fetch = opts.fetch.fn || defaultFetch;\n        autoDecodeResponse = !!opts.fetch.autoDecodeResponse;\n      }\n    }\n    getPublicPath = opts.getPublicPath || opts.getDomain || defaultGetPublicPath;\n    getTemplate = opts.getTemplate || defaultGetTemplate;\n  }\n  return embedHTMLCache[url] || (embedHTMLCache[url] = fetch(url).then(function (response) {\n    return readResAsString(response, autoDecodeResponse);\n  }).then(function (html) {\n    var assetPublicPath = getPublicPath(url);\n    var _processTpl = processTpl(getTemplate(html), assetPublicPath, postProcessTemplate),\n      template = _processTpl.template,\n      scripts = _processTpl.scripts,\n      entry = _processTpl.entry,\n      styles = _processTpl.styles;\n    return getEmbedHTML(template, styles, {\n      fetch: fetch\n    }).then(function (embedHTML) {\n      return {\n        template: embedHTML,\n        assetPublicPath: assetPublicPath,\n        getExternalScripts: function getExternalScripts() {\n          return _getExternalScripts(scripts, fetch);\n        },\n        getExternalStyleSheets: function getExternalStyleSheets() {\n          return _getExternalStyleSheets(styles, fetch);\n        },\n        execScripts: function execScripts(proxy, strictGlobal) {\n          var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n          if (!scripts.length) {\n            return Promise.resolve();\n          }\n          return _execScripts(entry, scripts, proxy, _objectSpread({\n            fetch: fetch,\n            strictGlobal: strictGlobal\n          }, opts));\n        }\n      };\n    });\n  }));\n}\nexport function importEntry(entry) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var _opts$fetch3 = opts.fetch,\n    fetch = _opts$fetch3 === void 0 ? defaultFetch : _opts$fetch3,\n    _opts$getTemplate = opts.getTemplate,\n    getTemplate = _opts$getTemplate === void 0 ? defaultGetTemplate : _opts$getTemplate,\n    postProcessTemplate = opts.postProcessTemplate;\n  var getPublicPath = opts.getPublicPath || opts.getDomain || defaultGetPublicPath;\n  if (!entry) {\n    throw new SyntaxError('entry should not be empty!');\n  }\n\n  // html entry\n  if (typeof entry === 'string') {\n    return importHTML(entry, {\n      fetch: fetch,\n      getPublicPath: getPublicPath,\n      getTemplate: getTemplate,\n      postProcessTemplate: postProcessTemplate\n    });\n  }\n\n  // config entry\n  if (Array.isArray(entry.scripts) || Array.isArray(entry.styles)) {\n    var _entry$scripts = entry.scripts,\n      scripts = _entry$scripts === void 0 ? [] : _entry$scripts,\n      _entry$styles = entry.styles,\n      styles = _entry$styles === void 0 ? [] : _entry$styles,\n      _entry$html = entry.html,\n      html = _entry$html === void 0 ? '' : _entry$html;\n    var getHTMLWithStylePlaceholder = function getHTMLWithStylePlaceholder(tpl) {\n      return styles.reduceRight(function (html, styleSrc) {\n        return \"\".concat(genLinkReplaceSymbol(styleSrc)).concat(html);\n      }, tpl);\n    };\n    var getHTMLWithScriptPlaceholder = function getHTMLWithScriptPlaceholder(tpl) {\n      return scripts.reduce(function (html, scriptSrc) {\n        return \"\".concat(html).concat(genScriptReplaceSymbol(scriptSrc));\n      }, tpl);\n    };\n    return getEmbedHTML(getTemplate(getHTMLWithScriptPlaceholder(getHTMLWithStylePlaceholder(html))), styles, {\n      fetch: fetch\n    }).then(function (embedHTML) {\n      return {\n        template: embedHTML,\n        assetPublicPath: getPublicPath(entry),\n        getExternalScripts: function getExternalScripts() {\n          return _getExternalScripts(scripts, fetch);\n        },\n        getExternalStyleSheets: function getExternalStyleSheets() {\n          return _getExternalStyleSheets(styles, fetch);\n        },\n        execScripts: function execScripts(proxy, strictGlobal) {\n          var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n          if (!scripts.length) {\n            return Promise.resolve();\n          }\n          return _execScripts(scripts[scripts.length - 1], scripts, proxy, _objectSpread({\n            fetch: fetch,\n            strictGlobal: strictGlobal\n          }, opts));\n        }\n      };\n    });\n  } else {\n    throw new SyntaxError('entry scripts or styles should be array!');\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}