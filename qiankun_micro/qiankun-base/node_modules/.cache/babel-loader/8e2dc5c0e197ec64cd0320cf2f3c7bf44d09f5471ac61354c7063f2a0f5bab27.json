{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _concat from \"lodash/concat\";\nimport _mergeWith2 from \"lodash/mergeWith\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _forEach from \"lodash/forEach\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _excluded = [\"singular\", \"sandbox\", \"excludeAssetFilter\", \"globalContext\"];\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n/**\n * @author Kuitos\n * @since 2020-04-01\n */\nimport { importEntry } from 'import-html-entry';\nimport getAddOns from './addons';\nimport { QiankunError } from './error';\nimport { getMicroAppStateActions } from './globalState';\nimport { createSandboxContainer, css } from './sandbox';\nimport { cachedGlobals } from './sandbox/proxySandbox';\nimport { Deferred, genAppInstanceIdByName, getContainer, getDefaultTplWrapper, getWrapperId, isEnableScopedCSS, performanceGetEntriesByName, performanceMark, performanceMeasure, toArray, validateExportLifecycle } from './utils';\nfunction assertElementExist(element, msg) {\n  if (!element) {\n    if (msg) {\n      throw new QiankunError(msg);\n    }\n    throw new QiankunError('element not existed!');\n  }\n}\nfunction execHooksChain(hooks, app) {\n  var global = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : window;\n  if (hooks.length) {\n    return hooks.reduce(function (chain, hook) {\n      return chain.then(function () {\n        return hook(app, global);\n      });\n    }, Promise.resolve());\n  }\n  return Promise.resolve();\n}\nfunction validateSingularMode(_x, _x2) {\n  return _validateSingularMode.apply(this, arguments);\n}\nfunction _validateSingularMode() {\n  _validateSingularMode = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(validate, app) {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          return _context.abrupt(\"return\", typeof validate === 'function' ? validate(app) : !!validate);\n        case 1:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return _validateSingularMode.apply(this, arguments);\n}\nvar supportShadowDOM = !!document.head.attachShadow || !!document.head.createShadowRoot;\nfunction createElement(appContent, strictStyleIsolation, scopedCSS, appInstanceId) {\n  var containerElement = document.createElement('div');\n  containerElement.innerHTML = appContent;\n  // appContent always wrapped with a singular div\n  var appElement = containerElement.firstChild;\n  if (strictStyleIsolation) {\n    if (!supportShadowDOM) {\n      console.warn('[qiankun]: As current browser not support shadow dom, your strictStyleIsolation configuration will be ignored!');\n    } else {\n      var innerHTML = appElement.innerHTML;\n      appElement.innerHTML = '';\n      var shadow;\n      if (appElement.attachShadow) {\n        shadow = appElement.attachShadow({\n          mode: 'open'\n        });\n      } else {\n        // createShadowRoot was proposed in initial spec, which has then been deprecated\n        shadow = appElement.createShadowRoot();\n      }\n      shadow.innerHTML = innerHTML;\n    }\n  }\n  if (scopedCSS) {\n    var attr = appElement.getAttribute(css.QiankunCSSRewriteAttr);\n    if (!attr) {\n      appElement.setAttribute(css.QiankunCSSRewriteAttr, appInstanceId);\n    }\n    var styleNodes = appElement.querySelectorAll('style') || [];\n    _forEach(styleNodes, function (stylesheetElement) {\n      css.process(appElement, stylesheetElement, appInstanceId);\n    });\n  }\n  return appElement;\n}\n/** generate app wrapper dom getter */\nfunction getAppWrapperGetter(appInstanceId, useLegacyRender, strictStyleIsolation, scopedCSS, elementGetter) {\n  return function () {\n    if (useLegacyRender) {\n      if (strictStyleIsolation) throw new QiankunError('strictStyleIsolation can not be used with legacy render!');\n      if (scopedCSS) throw new QiankunError('experimentalStyleIsolation can not be used with legacy render!');\n      var appWrapper = document.getElementById(getWrapperId(appInstanceId));\n      assertElementExist(appWrapper, \"Wrapper element for \".concat(appInstanceId, \" is not existed!\"));\n      return appWrapper;\n    }\n    var element = elementGetter();\n    assertElementExist(element, \"Wrapper element for \".concat(appInstanceId, \" is not existed!\"));\n    if (strictStyleIsolation && supportShadowDOM) {\n      return element.shadowRoot;\n    }\n    return element;\n  };\n}\nvar rawAppendChild = HTMLElement.prototype.appendChild;\nvar rawRemoveChild = HTMLElement.prototype.removeChild;\n/**\n * Get the render function\n * If the legacy render function is provide, used as it, otherwise we will insert the app element to target container by qiankun\n * @param appInstanceId\n * @param appContent\n * @param legacyRender\n */\nfunction getRender(appInstanceId, appContent, legacyRender) {\n  var render = function render(_ref, phase) {\n    var element = _ref.element,\n      loading = _ref.loading,\n      container = _ref.container;\n    if (legacyRender) {\n      if (process.env.NODE_ENV === 'development') {\n        console.error('[qiankun] Custom rendering function is deprecated and will be removed in 3.0, you can use the container element setting instead!');\n      }\n      return legacyRender({\n        loading: loading,\n        appContent: element ? appContent : ''\n      });\n    }\n    var containerElement = getContainer(container);\n    // The container might have be removed after micro app unmounted.\n    // Such as the micro app unmount lifecycle called by a react componentWillUnmount lifecycle, after micro app unmounted, the react component might also be removed\n    if (phase !== 'unmounted') {\n      var errorMsg = function () {\n        switch (phase) {\n          case 'loading':\n          case 'mounting':\n            return \"Target container with \".concat(container, \" not existed while \").concat(appInstanceId, \" \").concat(phase, \"!\");\n          case 'mounted':\n            return \"Target container with \".concat(container, \" not existed after \").concat(appInstanceId, \" \").concat(phase, \"!\");\n          default:\n            return \"Target container with \".concat(container, \" not existed while \").concat(appInstanceId, \" rendering!\");\n        }\n      }();\n      assertElementExist(containerElement, errorMsg);\n    }\n    if (containerElement && !containerElement.contains(element)) {\n      // clear the container\n      while (containerElement.firstChild) {\n        rawRemoveChild.call(containerElement, containerElement.firstChild);\n      }\n      // append the element to container if it exist\n      if (element) {\n        rawAppendChild.call(containerElement, element);\n      }\n    }\n    return undefined;\n  };\n  return render;\n}\nfunction getLifecyclesFromExports(scriptExports, appName, global, globalLatestSetProp) {\n  if (validateExportLifecycle(scriptExports)) {\n    return scriptExports;\n  }\n  // fallback to sandbox latest set property if it had\n  if (globalLatestSetProp) {\n    var lifecycles = global[globalLatestSetProp];\n    if (validateExportLifecycle(lifecycles)) {\n      return lifecycles;\n    }\n  }\n  if (process.env.NODE_ENV === 'development') {\n    console.warn(\"[qiankun] lifecycle not found from \".concat(appName, \" entry exports, fallback to get from window['\").concat(appName, \"']\"));\n  }\n  // fallback to global variable who named with ${appName} while module exports not found\n  var globalVariableExports = global[appName];\n  if (validateExportLifecycle(globalVariableExports)) {\n    return globalVariableExports;\n  }\n  throw new QiankunError(\"You need to export lifecycle functions in \".concat(appName, \" entry\"));\n}\nvar prevAppUnmountedDeferred;\nexport function loadApp(_x3) {\n  return _loadApp.apply(this, arguments);\n}\nfunction _loadApp() {\n  _loadApp = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee17(app) {\n    var _sandboxContainer, _sandboxContainer$ins;\n    var configuration,\n      lifeCycles,\n      entry,\n      appName,\n      appInstanceId,\n      markName,\n      _configuration$singul,\n      singular,\n      _configuration$sandbo,\n      sandbox,\n      excludeAssetFilter,\n      _configuration$global,\n      globalContext,\n      importEntryOpts,\n      _yield$importEntry,\n      template,\n      execScripts,\n      assetPublicPath,\n      getExternalScripts,\n      appContent,\n      strictStyleIsolation,\n      scopedCSS,\n      initialAppWrapperElement,\n      initialContainer,\n      legacyRender,\n      render,\n      initialAppWrapperGetter,\n      global,\n      mountSandbox,\n      unmountSandbox,\n      useLooseSandbox,\n      speedySandbox,\n      sandboxContainer,\n      _mergeWith,\n      _mergeWith$beforeUnmo,\n      beforeUnmount,\n      _mergeWith$afterUnmou,\n      afterUnmount,\n      _mergeWith$afterMount,\n      afterMount,\n      _mergeWith$beforeMoun,\n      beforeMount,\n      _mergeWith$beforeLoad,\n      beforeLoad,\n      scriptExports,\n      _getLifecyclesFromExp,\n      bootstrap,\n      mount,\n      unmount,\n      update,\n      _getMicroAppStateActi,\n      onGlobalStateChange,\n      setGlobalState,\n      offGlobalStateChange,\n      syncAppWrapperElement2Sandbox,\n      parcelConfigGetter,\n      _args17 = arguments;\n    return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n      while (1) switch (_context17.prev = _context17.next) {\n        case 0:\n          configuration = _args17.length > 1 && _args17[1] !== undefined ? _args17[1] : {};\n          lifeCycles = _args17.length > 2 ? _args17[2] : undefined;\n          entry = app.entry, appName = app.name;\n          appInstanceId = genAppInstanceIdByName(appName);\n          markName = \"[qiankun] App \".concat(appInstanceId, \" Loading\");\n          if (process.env.NODE_ENV === 'development') {\n            performanceMark(markName);\n          }\n          _configuration$singul = configuration.singular, singular = _configuration$singul === void 0 ? false : _configuration$singul, _configuration$sandbo = configuration.sandbox, sandbox = _configuration$sandbo === void 0 ? true : _configuration$sandbo, excludeAssetFilter = configuration.excludeAssetFilter, _configuration$global = configuration.globalContext, globalContext = _configuration$global === void 0 ? window : _configuration$global, importEntryOpts = _objectWithoutProperties(configuration, _excluded); // get the entry html content and script executor\n          _context17.next = 9;\n          return importEntry(entry, importEntryOpts);\n        case 9:\n          _yield$importEntry = _context17.sent;\n          template = _yield$importEntry.template;\n          execScripts = _yield$importEntry.execScripts;\n          assetPublicPath = _yield$importEntry.assetPublicPath;\n          getExternalScripts = _yield$importEntry.getExternalScripts;\n          _context17.next = 16;\n          return getExternalScripts();\n        case 16:\n          _context17.next = 18;\n          return validateSingularMode(singular, app);\n        case 18:\n          if (!_context17.sent) {\n            _context17.next = 21;\n            break;\n          }\n          _context17.next = 21;\n          return prevAppUnmountedDeferred && prevAppUnmountedDeferred.promise;\n        case 21:\n          appContent = getDefaultTplWrapper(appInstanceId, sandbox)(template);\n          strictStyleIsolation = _typeof(sandbox) === 'object' && !!sandbox.strictStyleIsolation;\n          if (process.env.NODE_ENV === 'development' && strictStyleIsolation) {\n            console.warn(\"[qiankun] strictStyleIsolation configuration will be removed in 3.0, pls don't depend on it or use experimentalStyleIsolation instead!\");\n          }\n          scopedCSS = isEnableScopedCSS(sandbox);\n          initialAppWrapperElement = createElement(appContent, strictStyleIsolation, scopedCSS, appInstanceId);\n          initialContainer = 'container' in app ? app.container : undefined;\n          legacyRender = 'render' in app ? app.render : undefined;\n          render = getRender(appInstanceId, appContent, legacyRender); // 第一次加载设置应用可见区域 dom 结构\n          // 确保每次应用加载前容器 dom 结构已经设置完毕\n          render({\n            element: initialAppWrapperElement,\n            loading: true,\n            container: initialContainer\n          }, 'loading');\n          initialAppWrapperGetter = getAppWrapperGetter(appInstanceId, !!legacyRender, strictStyleIsolation, scopedCSS, function () {\n            return initialAppWrapperElement;\n          });\n          global = globalContext;\n          mountSandbox = function mountSandbox() {\n            return Promise.resolve();\n          };\n          unmountSandbox = function unmountSandbox() {\n            return Promise.resolve();\n          };\n          useLooseSandbox = _typeof(sandbox) === 'object' && !!sandbox.loose; // enable speedy mode by default\n          speedySandbox = _typeof(sandbox) === 'object' ? sandbox.speedy !== false : true;\n          if (sandbox) {\n            sandboxContainer = createSandboxContainer(appInstanceId,\n            // FIXME should use a strict sandbox logic while remount, see https://github.com/umijs/qiankun/issues/518\n            initialAppWrapperGetter, scopedCSS, useLooseSandbox, excludeAssetFilter, global, speedySandbox);\n            // 用沙箱的代理对象作为接下来使用的全局对象\n            global = sandboxContainer.instance.proxy;\n            mountSandbox = sandboxContainer.mount;\n            unmountSandbox = sandboxContainer.unmount;\n          }\n          _mergeWith = _mergeWith2({}, getAddOns(global, assetPublicPath), lifeCycles, function (v1, v2) {\n            return _concat(v1 !== null && v1 !== void 0 ? v1 : [], v2 !== null && v2 !== void 0 ? v2 : []);\n          }), _mergeWith$beforeUnmo = _mergeWith.beforeUnmount, beforeUnmount = _mergeWith$beforeUnmo === void 0 ? [] : _mergeWith$beforeUnmo, _mergeWith$afterUnmou = _mergeWith.afterUnmount, afterUnmount = _mergeWith$afterUnmou === void 0 ? [] : _mergeWith$afterUnmou, _mergeWith$afterMount = _mergeWith.afterMount, afterMount = _mergeWith$afterMount === void 0 ? [] : _mergeWith$afterMount, _mergeWith$beforeMoun = _mergeWith.beforeMount, beforeMount = _mergeWith$beforeMoun === void 0 ? [] : _mergeWith$beforeMoun, _mergeWith$beforeLoad = _mergeWith.beforeLoad, beforeLoad = _mergeWith$beforeLoad === void 0 ? [] : _mergeWith$beforeLoad;\n          _context17.next = 40;\n          return execHooksChain(toArray(beforeLoad), app, global);\n        case 40:\n          _context17.next = 42;\n          return execScripts(global, sandbox && !useLooseSandbox, {\n            scopedGlobalVariables: speedySandbox ? cachedGlobals : []\n          });\n        case 42:\n          scriptExports = _context17.sent;\n          _getLifecyclesFromExp = getLifecyclesFromExports(scriptExports, appName, global, (_sandboxContainer = sandboxContainer) === null || _sandboxContainer === void 0 ? void 0 : (_sandboxContainer$ins = _sandboxContainer.instance) === null || _sandboxContainer$ins === void 0 ? void 0 : _sandboxContainer$ins.latestSetProp), bootstrap = _getLifecyclesFromExp.bootstrap, mount = _getLifecyclesFromExp.mount, unmount = _getLifecyclesFromExp.unmount, update = _getLifecyclesFromExp.update;\n          _getMicroAppStateActi = getMicroAppStateActions(appInstanceId), onGlobalStateChange = _getMicroAppStateActi.onGlobalStateChange, setGlobalState = _getMicroAppStateActi.setGlobalState, offGlobalStateChange = _getMicroAppStateActi.offGlobalStateChange; // FIXME temporary way\n          syncAppWrapperElement2Sandbox = function syncAppWrapperElement2Sandbox(element) {\n            return initialAppWrapperElement = element;\n          };\n          parcelConfigGetter = function parcelConfigGetter() {\n            var remountContainer = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialContainer;\n            var appWrapperElement;\n            var appWrapperGetter;\n            var parcelConfig = {\n              name: appInstanceId,\n              bootstrap: bootstrap,\n              mount: [/*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                var marks;\n                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                  while (1) switch (_context2.prev = _context2.next) {\n                    case 0:\n                      if (process.env.NODE_ENV === 'development') {\n                        marks = performanceGetEntriesByName(markName, 'mark'); // mark length is zero means the app is remounting\n                        if (marks && !marks.length) {\n                          performanceMark(markName);\n                        }\n                      }\n                    case 1:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }, _callee2);\n              })), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n                return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                  while (1) switch (_context3.prev = _context3.next) {\n                    case 0:\n                      _context3.next = 2;\n                      return validateSingularMode(singular, app);\n                    case 2:\n                      _context3.t0 = _context3.sent;\n                      if (!_context3.t0) {\n                        _context3.next = 5;\n                        break;\n                      }\n                      _context3.t0 = prevAppUnmountedDeferred;\n                    case 5:\n                      if (!_context3.t0) {\n                        _context3.next = 7;\n                        break;\n                      }\n                      return _context3.abrupt(\"return\", prevAppUnmountedDeferred.promise);\n                    case 7:\n                      return _context3.abrupt(\"return\", undefined);\n                    case 8:\n                    case \"end\":\n                      return _context3.stop();\n                  }\n                }, _callee3);\n              })), /*#__PURE__*/\n              // initial wrapper element before app mount/remount\n              _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n                return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                  while (1) switch (_context4.prev = _context4.next) {\n                    case 0:\n                      appWrapperElement = initialAppWrapperElement;\n                      appWrapperGetter = getAppWrapperGetter(appInstanceId, !!legacyRender, strictStyleIsolation, scopedCSS, function () {\n                        return appWrapperElement;\n                      });\n                    case 2:\n                    case \"end\":\n                      return _context4.stop();\n                  }\n                }, _callee4);\n              })), /*#__PURE__*/\n              // 添加 mount hook, 确保每次应用加载前容器 dom 结构已经设置完毕\n              _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n                var useNewContainer;\n                return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                  while (1) switch (_context5.prev = _context5.next) {\n                    case 0:\n                      useNewContainer = remountContainer !== initialContainer;\n                      if (useNewContainer || !appWrapperElement) {\n                        // element will be destroyed after unmounted, we need to recreate it if it not exist\n                        // or we try to remount into a new container\n                        appWrapperElement = createElement(appContent, strictStyleIsolation, scopedCSS, appInstanceId);\n                        syncAppWrapperElement2Sandbox(appWrapperElement);\n                      }\n                      render({\n                        element: appWrapperElement,\n                        loading: true,\n                        container: remountContainer\n                      }, 'mounting');\n                    case 3:\n                    case \"end\":\n                      return _context5.stop();\n                  }\n                }, _callee5);\n              })), mountSandbox, /*#__PURE__*/\n              // exec the chain after rendering to keep the behavior with beforeLoad\n              _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n                return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                  while (1) switch (_context6.prev = _context6.next) {\n                    case 0:\n                      return _context6.abrupt(\"return\", execHooksChain(toArray(beforeMount), app, global));\n                    case 1:\n                    case \"end\":\n                      return _context6.stop();\n                  }\n                }, _callee6);\n              })), /*#__PURE__*/function () {\n                var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(props) {\n                  return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n                    while (1) switch (_context7.prev = _context7.next) {\n                      case 0:\n                        return _context7.abrupt(\"return\", mount(_objectSpread(_objectSpread({}, props), {}, {\n                          container: appWrapperGetter(),\n                          setGlobalState: setGlobalState,\n                          onGlobalStateChange: onGlobalStateChange\n                        })));\n                      case 1:\n                      case \"end\":\n                        return _context7.stop();\n                    }\n                  }, _callee7);\n                }));\n                return function (_x4) {\n                  return _ref7.apply(this, arguments);\n                };\n              }(), /*#__PURE__*/\n              // finish loading after app mounted\n              _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n                return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n                  while (1) switch (_context8.prev = _context8.next) {\n                    case 0:\n                      return _context8.abrupt(\"return\", render({\n                        element: appWrapperElement,\n                        loading: false,\n                        container: remountContainer\n                      }, 'mounted'));\n                    case 1:\n                    case \"end\":\n                      return _context8.stop();\n                  }\n                }, _callee8);\n              })), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n                return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n                  while (1) switch (_context9.prev = _context9.next) {\n                    case 0:\n                      return _context9.abrupt(\"return\", execHooksChain(toArray(afterMount), app, global));\n                    case 1:\n                    case \"end\":\n                      return _context9.stop();\n                  }\n                }, _callee9);\n              })), /*#__PURE__*/\n              // initialize the unmount defer after app mounted and resolve the defer after it unmounted\n              _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n                return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n                  while (1) switch (_context10.prev = _context10.next) {\n                    case 0:\n                      _context10.next = 2;\n                      return validateSingularMode(singular, app);\n                    case 2:\n                      if (!_context10.sent) {\n                        _context10.next = 4;\n                        break;\n                      }\n                      prevAppUnmountedDeferred = new Deferred();\n                    case 4:\n                    case \"end\":\n                      return _context10.stop();\n                  }\n                }, _callee10);\n              })), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11() {\n                var measureName;\n                return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n                  while (1) switch (_context11.prev = _context11.next) {\n                    case 0:\n                      if (process.env.NODE_ENV === 'development') {\n                        measureName = \"[qiankun] App \".concat(appInstanceId, \" Loading Consuming\");\n                        performanceMeasure(measureName, markName);\n                      }\n                    case 1:\n                    case \"end\":\n                      return _context11.stop();\n                  }\n                }, _callee11);\n              }))],\n              unmount: [/*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12() {\n                return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n                  while (1) switch (_context12.prev = _context12.next) {\n                    case 0:\n                      return _context12.abrupt(\"return\", execHooksChain(toArray(beforeUnmount), app, global));\n                    case 1:\n                    case \"end\":\n                      return _context12.stop();\n                  }\n                }, _callee12);\n              })), /*#__PURE__*/function () {\n                var _ref13 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13(props) {\n                  return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n                    while (1) switch (_context13.prev = _context13.next) {\n                      case 0:\n                        return _context13.abrupt(\"return\", unmount(_objectSpread(_objectSpread({}, props), {}, {\n                          container: appWrapperGetter()\n                        })));\n                      case 1:\n                      case \"end\":\n                        return _context13.stop();\n                    }\n                  }, _callee13);\n                }));\n                return function (_x5) {\n                  return _ref13.apply(this, arguments);\n                };\n              }(), unmountSandbox, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee14() {\n                return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n                  while (1) switch (_context14.prev = _context14.next) {\n                    case 0:\n                      return _context14.abrupt(\"return\", execHooksChain(toArray(afterUnmount), app, global));\n                    case 1:\n                    case \"end\":\n                      return _context14.stop();\n                  }\n                }, _callee14);\n              })), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee15() {\n                return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n                  while (1) switch (_context15.prev = _context15.next) {\n                    case 0:\n                      render({\n                        element: null,\n                        loading: false,\n                        container: remountContainer\n                      }, 'unmounted');\n                      offGlobalStateChange(appInstanceId);\n                      // for gc\n                      appWrapperElement = null;\n                      syncAppWrapperElement2Sandbox(appWrapperElement);\n                    case 4:\n                    case \"end\":\n                      return _context15.stop();\n                  }\n                }, _callee15);\n              })), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee16() {\n                return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n                  while (1) switch (_context16.prev = _context16.next) {\n                    case 0:\n                      _context16.next = 2;\n                      return validateSingularMode(singular, app);\n                    case 2:\n                      _context16.t0 = _context16.sent;\n                      if (!_context16.t0) {\n                        _context16.next = 5;\n                        break;\n                      }\n                      _context16.t0 = prevAppUnmountedDeferred;\n                    case 5:\n                      if (!_context16.t0) {\n                        _context16.next = 7;\n                        break;\n                      }\n                      prevAppUnmountedDeferred.resolve();\n                    case 7:\n                    case \"end\":\n                      return _context16.stop();\n                  }\n                }, _callee16);\n              }))]\n            };\n            if (typeof update === 'function') {\n              parcelConfig.update = update;\n            }\n            return parcelConfig;\n          };\n          return _context17.abrupt(\"return\", parcelConfigGetter);\n        case 48:\n        case \"end\":\n          return _context17.stop();\n      }\n    }, _callee17);\n  }));\n  return _loadApp.apply(this, arguments);\n}","map":{"version":3,"names":["_objectSpread","_concat","_mergeWith2","_typeof","_objectWithoutProperties","_forEach","_asyncToGenerator","_excluded","_regeneratorRuntime","importEntry","getAddOns","QiankunError","getMicroAppStateActions","createSandboxContainer","css","cachedGlobals","Deferred","genAppInstanceIdByName","getContainer","getDefaultTplWrapper","getWrapperId","isEnableScopedCSS","performanceGetEntriesByName","performanceMark","performanceMeasure","toArray","validateExportLifecycle","assertElementExist","element","msg","execHooksChain","hooks","app","global","arguments","length","undefined","window","reduce","chain","hook","then","Promise","resolve","validateSingularMode","_x","_x2","_validateSingularMode","apply","mark","_callee","validate","wrap","_callee$","_context","prev","next","abrupt","stop","supportShadowDOM","document","head","attachShadow","createShadowRoot","createElement","appContent","strictStyleIsolation","scopedCSS","appInstanceId","containerElement","innerHTML","appElement","firstChild","console","warn","shadow","mode","attr","getAttribute","QiankunCSSRewriteAttr","setAttribute","styleNodes","querySelectorAll","stylesheetElement","process","getAppWrapperGetter","useLegacyRender","elementGetter","appWrapper","getElementById","concat","shadowRoot","rawAppendChild","HTMLElement","prototype","appendChild","rawRemoveChild","removeChild","getRender","legacyRender","render","_ref","phase","loading","container","env","NODE_ENV","error","errorMsg","contains","call","getLifecyclesFromExports","scriptExports","appName","globalLatestSetProp","lifecycles","globalVariableExports","prevAppUnmountedDeferred","loadApp","_x3","_loadApp","_callee17","_sandboxContainer","_sandboxContainer$ins","configuration","lifeCycles","entry","markName","_configuration$singul","singular","_configuration$sandbo","sandbox","excludeAssetFilter","_configuration$global","globalContext","importEntryOpts","_yield$importEntry","template","execScripts","assetPublicPath","getExternalScripts","initialAppWrapperElement","initialContainer","initialAppWrapperGetter","mountSandbox","unmountSandbox","useLooseSandbox","speedySandbox","sandboxContainer","_mergeWith","_mergeWith$beforeUnmo","beforeUnmount","_mergeWith$afterUnmou","afterUnmount","_mergeWith$afterMount","afterMount","_mergeWith$beforeMoun","beforeMount","_mergeWith$beforeLoad","beforeLoad","_getLifecyclesFromExp","bootstrap","mount","unmount","update","_getMicroAppStateActi","onGlobalStateChange","setGlobalState","offGlobalStateChange","syncAppWrapperElement2Sandbox","parcelConfigGetter","_args17","_callee17$","_context17","name","sent","promise","loose","speedy","instance","proxy","v1","v2","scopedGlobalVariables","latestSetProp","remountContainer","appWrapperElement","appWrapperGetter","parcelConfig","_callee2","marks","_callee2$","_context2","_callee3","_callee3$","_context3","t0","_callee4","_callee4$","_context4","_callee5","useNewContainer","_callee5$","_context5","_callee6","_callee6$","_context6","_ref7","_callee7","props","_callee7$","_context7","_x4","_callee8","_callee8$","_context8","_callee9","_callee9$","_context9","_callee10","_callee10$","_context10","_callee11","measureName","_callee11$","_context11","_callee12","_callee12$","_context12","_ref13","_callee13","_callee13$","_context13","_x5","_callee14","_callee14$","_context14","_callee15","_callee15$","_context15","_callee16","_callee16$","_context16"],"sources":["/home/lishu/桌面/Micro_frontend_practice/qiankun_micro/qiankun-base/node_modules/qiankun/es/loader.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _concat from \"lodash/concat\";\nimport _mergeWith2 from \"lodash/mergeWith\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _forEach from \"lodash/forEach\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _excluded = [\"singular\", \"sandbox\", \"excludeAssetFilter\", \"globalContext\"];\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n/**\n * @author Kuitos\n * @since 2020-04-01\n */\nimport { importEntry } from 'import-html-entry';\nimport getAddOns from './addons';\nimport { QiankunError } from './error';\nimport { getMicroAppStateActions } from './globalState';\nimport { createSandboxContainer, css } from './sandbox';\nimport { cachedGlobals } from './sandbox/proxySandbox';\nimport { Deferred, genAppInstanceIdByName, getContainer, getDefaultTplWrapper, getWrapperId, isEnableScopedCSS, performanceGetEntriesByName, performanceMark, performanceMeasure, toArray, validateExportLifecycle } from './utils';\nfunction assertElementExist(element, msg) {\n  if (!element) {\n    if (msg) {\n      throw new QiankunError(msg);\n    }\n    throw new QiankunError('element not existed!');\n  }\n}\nfunction execHooksChain(hooks, app) {\n  var global = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : window;\n  if (hooks.length) {\n    return hooks.reduce(function (chain, hook) {\n      return chain.then(function () {\n        return hook(app, global);\n      });\n    }, Promise.resolve());\n  }\n  return Promise.resolve();\n}\nfunction validateSingularMode(_x, _x2) {\n  return _validateSingularMode.apply(this, arguments);\n}\nfunction _validateSingularMode() {\n  _validateSingularMode = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(validate, app) {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          return _context.abrupt(\"return\", typeof validate === 'function' ? validate(app) : !!validate);\n        case 1:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return _validateSingularMode.apply(this, arguments);\n}\nvar supportShadowDOM = !!document.head.attachShadow || !!document.head.createShadowRoot;\nfunction createElement(appContent, strictStyleIsolation, scopedCSS, appInstanceId) {\n  var containerElement = document.createElement('div');\n  containerElement.innerHTML = appContent;\n  // appContent always wrapped with a singular div\n  var appElement = containerElement.firstChild;\n  if (strictStyleIsolation) {\n    if (!supportShadowDOM) {\n      console.warn('[qiankun]: As current browser not support shadow dom, your strictStyleIsolation configuration will be ignored!');\n    } else {\n      var innerHTML = appElement.innerHTML;\n      appElement.innerHTML = '';\n      var shadow;\n      if (appElement.attachShadow) {\n        shadow = appElement.attachShadow({\n          mode: 'open'\n        });\n      } else {\n        // createShadowRoot was proposed in initial spec, which has then been deprecated\n        shadow = appElement.createShadowRoot();\n      }\n      shadow.innerHTML = innerHTML;\n    }\n  }\n  if (scopedCSS) {\n    var attr = appElement.getAttribute(css.QiankunCSSRewriteAttr);\n    if (!attr) {\n      appElement.setAttribute(css.QiankunCSSRewriteAttr, appInstanceId);\n    }\n    var styleNodes = appElement.querySelectorAll('style') || [];\n    _forEach(styleNodes, function (stylesheetElement) {\n      css.process(appElement, stylesheetElement, appInstanceId);\n    });\n  }\n  return appElement;\n}\n/** generate app wrapper dom getter */\nfunction getAppWrapperGetter(appInstanceId, useLegacyRender, strictStyleIsolation, scopedCSS, elementGetter) {\n  return function () {\n    if (useLegacyRender) {\n      if (strictStyleIsolation) throw new QiankunError('strictStyleIsolation can not be used with legacy render!');\n      if (scopedCSS) throw new QiankunError('experimentalStyleIsolation can not be used with legacy render!');\n      var appWrapper = document.getElementById(getWrapperId(appInstanceId));\n      assertElementExist(appWrapper, \"Wrapper element for \".concat(appInstanceId, \" is not existed!\"));\n      return appWrapper;\n    }\n    var element = elementGetter();\n    assertElementExist(element, \"Wrapper element for \".concat(appInstanceId, \" is not existed!\"));\n    if (strictStyleIsolation && supportShadowDOM) {\n      return element.shadowRoot;\n    }\n    return element;\n  };\n}\nvar rawAppendChild = HTMLElement.prototype.appendChild;\nvar rawRemoveChild = HTMLElement.prototype.removeChild;\n/**\n * Get the render function\n * If the legacy render function is provide, used as it, otherwise we will insert the app element to target container by qiankun\n * @param appInstanceId\n * @param appContent\n * @param legacyRender\n */\nfunction getRender(appInstanceId, appContent, legacyRender) {\n  var render = function render(_ref, phase) {\n    var element = _ref.element,\n      loading = _ref.loading,\n      container = _ref.container;\n    if (legacyRender) {\n      if (process.env.NODE_ENV === 'development') {\n        console.error('[qiankun] Custom rendering function is deprecated and will be removed in 3.0, you can use the container element setting instead!');\n      }\n      return legacyRender({\n        loading: loading,\n        appContent: element ? appContent : ''\n      });\n    }\n    var containerElement = getContainer(container);\n    // The container might have be removed after micro app unmounted.\n    // Such as the micro app unmount lifecycle called by a react componentWillUnmount lifecycle, after micro app unmounted, the react component might also be removed\n    if (phase !== 'unmounted') {\n      var errorMsg = function () {\n        switch (phase) {\n          case 'loading':\n          case 'mounting':\n            return \"Target container with \".concat(container, \" not existed while \").concat(appInstanceId, \" \").concat(phase, \"!\");\n          case 'mounted':\n            return \"Target container with \".concat(container, \" not existed after \").concat(appInstanceId, \" \").concat(phase, \"!\");\n          default:\n            return \"Target container with \".concat(container, \" not existed while \").concat(appInstanceId, \" rendering!\");\n        }\n      }();\n      assertElementExist(containerElement, errorMsg);\n    }\n    if (containerElement && !containerElement.contains(element)) {\n      // clear the container\n      while (containerElement.firstChild) {\n        rawRemoveChild.call(containerElement, containerElement.firstChild);\n      }\n      // append the element to container if it exist\n      if (element) {\n        rawAppendChild.call(containerElement, element);\n      }\n    }\n    return undefined;\n  };\n  return render;\n}\nfunction getLifecyclesFromExports(scriptExports, appName, global, globalLatestSetProp) {\n  if (validateExportLifecycle(scriptExports)) {\n    return scriptExports;\n  }\n  // fallback to sandbox latest set property if it had\n  if (globalLatestSetProp) {\n    var lifecycles = global[globalLatestSetProp];\n    if (validateExportLifecycle(lifecycles)) {\n      return lifecycles;\n    }\n  }\n  if (process.env.NODE_ENV === 'development') {\n    console.warn(\"[qiankun] lifecycle not found from \".concat(appName, \" entry exports, fallback to get from window['\").concat(appName, \"']\"));\n  }\n  // fallback to global variable who named with ${appName} while module exports not found\n  var globalVariableExports = global[appName];\n  if (validateExportLifecycle(globalVariableExports)) {\n    return globalVariableExports;\n  }\n  throw new QiankunError(\"You need to export lifecycle functions in \".concat(appName, \" entry\"));\n}\nvar prevAppUnmountedDeferred;\nexport function loadApp(_x3) {\n  return _loadApp.apply(this, arguments);\n}\nfunction _loadApp() {\n  _loadApp = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee17(app) {\n    var _sandboxContainer, _sandboxContainer$ins;\n    var configuration,\n      lifeCycles,\n      entry,\n      appName,\n      appInstanceId,\n      markName,\n      _configuration$singul,\n      singular,\n      _configuration$sandbo,\n      sandbox,\n      excludeAssetFilter,\n      _configuration$global,\n      globalContext,\n      importEntryOpts,\n      _yield$importEntry,\n      template,\n      execScripts,\n      assetPublicPath,\n      getExternalScripts,\n      appContent,\n      strictStyleIsolation,\n      scopedCSS,\n      initialAppWrapperElement,\n      initialContainer,\n      legacyRender,\n      render,\n      initialAppWrapperGetter,\n      global,\n      mountSandbox,\n      unmountSandbox,\n      useLooseSandbox,\n      speedySandbox,\n      sandboxContainer,\n      _mergeWith,\n      _mergeWith$beforeUnmo,\n      beforeUnmount,\n      _mergeWith$afterUnmou,\n      afterUnmount,\n      _mergeWith$afterMount,\n      afterMount,\n      _mergeWith$beforeMoun,\n      beforeMount,\n      _mergeWith$beforeLoad,\n      beforeLoad,\n      scriptExports,\n      _getLifecyclesFromExp,\n      bootstrap,\n      mount,\n      unmount,\n      update,\n      _getMicroAppStateActi,\n      onGlobalStateChange,\n      setGlobalState,\n      offGlobalStateChange,\n      syncAppWrapperElement2Sandbox,\n      parcelConfigGetter,\n      _args17 = arguments;\n    return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n      while (1) switch (_context17.prev = _context17.next) {\n        case 0:\n          configuration = _args17.length > 1 && _args17[1] !== undefined ? _args17[1] : {};\n          lifeCycles = _args17.length > 2 ? _args17[2] : undefined;\n          entry = app.entry, appName = app.name;\n          appInstanceId = genAppInstanceIdByName(appName);\n          markName = \"[qiankun] App \".concat(appInstanceId, \" Loading\");\n          if (process.env.NODE_ENV === 'development') {\n            performanceMark(markName);\n          }\n          _configuration$singul = configuration.singular, singular = _configuration$singul === void 0 ? false : _configuration$singul, _configuration$sandbo = configuration.sandbox, sandbox = _configuration$sandbo === void 0 ? true : _configuration$sandbo, excludeAssetFilter = configuration.excludeAssetFilter, _configuration$global = configuration.globalContext, globalContext = _configuration$global === void 0 ? window : _configuration$global, importEntryOpts = _objectWithoutProperties(configuration, _excluded); // get the entry html content and script executor\n          _context17.next = 9;\n          return importEntry(entry, importEntryOpts);\n        case 9:\n          _yield$importEntry = _context17.sent;\n          template = _yield$importEntry.template;\n          execScripts = _yield$importEntry.execScripts;\n          assetPublicPath = _yield$importEntry.assetPublicPath;\n          getExternalScripts = _yield$importEntry.getExternalScripts;\n          _context17.next = 16;\n          return getExternalScripts();\n        case 16:\n          _context17.next = 18;\n          return validateSingularMode(singular, app);\n        case 18:\n          if (!_context17.sent) {\n            _context17.next = 21;\n            break;\n          }\n          _context17.next = 21;\n          return prevAppUnmountedDeferred && prevAppUnmountedDeferred.promise;\n        case 21:\n          appContent = getDefaultTplWrapper(appInstanceId, sandbox)(template);\n          strictStyleIsolation = _typeof(sandbox) === 'object' && !!sandbox.strictStyleIsolation;\n          if (process.env.NODE_ENV === 'development' && strictStyleIsolation) {\n            console.warn(\"[qiankun] strictStyleIsolation configuration will be removed in 3.0, pls don't depend on it or use experimentalStyleIsolation instead!\");\n          }\n          scopedCSS = isEnableScopedCSS(sandbox);\n          initialAppWrapperElement = createElement(appContent, strictStyleIsolation, scopedCSS, appInstanceId);\n          initialContainer = 'container' in app ? app.container : undefined;\n          legacyRender = 'render' in app ? app.render : undefined;\n          render = getRender(appInstanceId, appContent, legacyRender); // 第一次加载设置应用可见区域 dom 结构\n          // 确保每次应用加载前容器 dom 结构已经设置完毕\n          render({\n            element: initialAppWrapperElement,\n            loading: true,\n            container: initialContainer\n          }, 'loading');\n          initialAppWrapperGetter = getAppWrapperGetter(appInstanceId, !!legacyRender, strictStyleIsolation, scopedCSS, function () {\n            return initialAppWrapperElement;\n          });\n          global = globalContext;\n          mountSandbox = function mountSandbox() {\n            return Promise.resolve();\n          };\n          unmountSandbox = function unmountSandbox() {\n            return Promise.resolve();\n          };\n          useLooseSandbox = _typeof(sandbox) === 'object' && !!sandbox.loose; // enable speedy mode by default\n          speedySandbox = _typeof(sandbox) === 'object' ? sandbox.speedy !== false : true;\n          if (sandbox) {\n            sandboxContainer = createSandboxContainer(appInstanceId,\n            // FIXME should use a strict sandbox logic while remount, see https://github.com/umijs/qiankun/issues/518\n            initialAppWrapperGetter, scopedCSS, useLooseSandbox, excludeAssetFilter, global, speedySandbox);\n            // 用沙箱的代理对象作为接下来使用的全局对象\n            global = sandboxContainer.instance.proxy;\n            mountSandbox = sandboxContainer.mount;\n            unmountSandbox = sandboxContainer.unmount;\n          }\n          _mergeWith = _mergeWith2({}, getAddOns(global, assetPublicPath), lifeCycles, function (v1, v2) {\n            return _concat(v1 !== null && v1 !== void 0 ? v1 : [], v2 !== null && v2 !== void 0 ? v2 : []);\n          }), _mergeWith$beforeUnmo = _mergeWith.beforeUnmount, beforeUnmount = _mergeWith$beforeUnmo === void 0 ? [] : _mergeWith$beforeUnmo, _mergeWith$afterUnmou = _mergeWith.afterUnmount, afterUnmount = _mergeWith$afterUnmou === void 0 ? [] : _mergeWith$afterUnmou, _mergeWith$afterMount = _mergeWith.afterMount, afterMount = _mergeWith$afterMount === void 0 ? [] : _mergeWith$afterMount, _mergeWith$beforeMoun = _mergeWith.beforeMount, beforeMount = _mergeWith$beforeMoun === void 0 ? [] : _mergeWith$beforeMoun, _mergeWith$beforeLoad = _mergeWith.beforeLoad, beforeLoad = _mergeWith$beforeLoad === void 0 ? [] : _mergeWith$beforeLoad;\n          _context17.next = 40;\n          return execHooksChain(toArray(beforeLoad), app, global);\n        case 40:\n          _context17.next = 42;\n          return execScripts(global, sandbox && !useLooseSandbox, {\n            scopedGlobalVariables: speedySandbox ? cachedGlobals : []\n          });\n        case 42:\n          scriptExports = _context17.sent;\n          _getLifecyclesFromExp = getLifecyclesFromExports(scriptExports, appName, global, (_sandboxContainer = sandboxContainer) === null || _sandboxContainer === void 0 ? void 0 : (_sandboxContainer$ins = _sandboxContainer.instance) === null || _sandboxContainer$ins === void 0 ? void 0 : _sandboxContainer$ins.latestSetProp), bootstrap = _getLifecyclesFromExp.bootstrap, mount = _getLifecyclesFromExp.mount, unmount = _getLifecyclesFromExp.unmount, update = _getLifecyclesFromExp.update;\n          _getMicroAppStateActi = getMicroAppStateActions(appInstanceId), onGlobalStateChange = _getMicroAppStateActi.onGlobalStateChange, setGlobalState = _getMicroAppStateActi.setGlobalState, offGlobalStateChange = _getMicroAppStateActi.offGlobalStateChange; // FIXME temporary way\n          syncAppWrapperElement2Sandbox = function syncAppWrapperElement2Sandbox(element) {\n            return initialAppWrapperElement = element;\n          };\n          parcelConfigGetter = function parcelConfigGetter() {\n            var remountContainer = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialContainer;\n            var appWrapperElement;\n            var appWrapperGetter;\n            var parcelConfig = {\n              name: appInstanceId,\n              bootstrap: bootstrap,\n              mount: [/*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                var marks;\n                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                  while (1) switch (_context2.prev = _context2.next) {\n                    case 0:\n                      if (process.env.NODE_ENV === 'development') {\n                        marks = performanceGetEntriesByName(markName, 'mark'); // mark length is zero means the app is remounting\n                        if (marks && !marks.length) {\n                          performanceMark(markName);\n                        }\n                      }\n                    case 1:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }, _callee2);\n              })), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n                return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                  while (1) switch (_context3.prev = _context3.next) {\n                    case 0:\n                      _context3.next = 2;\n                      return validateSingularMode(singular, app);\n                    case 2:\n                      _context3.t0 = _context3.sent;\n                      if (!_context3.t0) {\n                        _context3.next = 5;\n                        break;\n                      }\n                      _context3.t0 = prevAppUnmountedDeferred;\n                    case 5:\n                      if (!_context3.t0) {\n                        _context3.next = 7;\n                        break;\n                      }\n                      return _context3.abrupt(\"return\", prevAppUnmountedDeferred.promise);\n                    case 7:\n                      return _context3.abrupt(\"return\", undefined);\n                    case 8:\n                    case \"end\":\n                      return _context3.stop();\n                  }\n                }, _callee3);\n              })),\n              /*#__PURE__*/\n              // initial wrapper element before app mount/remount\n              _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n                return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                  while (1) switch (_context4.prev = _context4.next) {\n                    case 0:\n                      appWrapperElement = initialAppWrapperElement;\n                      appWrapperGetter = getAppWrapperGetter(appInstanceId, !!legacyRender, strictStyleIsolation, scopedCSS, function () {\n                        return appWrapperElement;\n                      });\n                    case 2:\n                    case \"end\":\n                      return _context4.stop();\n                  }\n                }, _callee4);\n              })),\n              /*#__PURE__*/\n              // 添加 mount hook, 确保每次应用加载前容器 dom 结构已经设置完毕\n              _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n                var useNewContainer;\n                return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                  while (1) switch (_context5.prev = _context5.next) {\n                    case 0:\n                      useNewContainer = remountContainer !== initialContainer;\n                      if (useNewContainer || !appWrapperElement) {\n                        // element will be destroyed after unmounted, we need to recreate it if it not exist\n                        // or we try to remount into a new container\n                        appWrapperElement = createElement(appContent, strictStyleIsolation, scopedCSS, appInstanceId);\n                        syncAppWrapperElement2Sandbox(appWrapperElement);\n                      }\n                      render({\n                        element: appWrapperElement,\n                        loading: true,\n                        container: remountContainer\n                      }, 'mounting');\n                    case 3:\n                    case \"end\":\n                      return _context5.stop();\n                  }\n                }, _callee5);\n              })), mountSandbox,\n              /*#__PURE__*/\n              // exec the chain after rendering to keep the behavior with beforeLoad\n              _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n                return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                  while (1) switch (_context6.prev = _context6.next) {\n                    case 0:\n                      return _context6.abrupt(\"return\", execHooksChain(toArray(beforeMount), app, global));\n                    case 1:\n                    case \"end\":\n                      return _context6.stop();\n                  }\n                }, _callee6);\n              })), /*#__PURE__*/function () {\n                var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(props) {\n                  return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n                    while (1) switch (_context7.prev = _context7.next) {\n                      case 0:\n                        return _context7.abrupt(\"return\", mount(_objectSpread(_objectSpread({}, props), {}, {\n                          container: appWrapperGetter(),\n                          setGlobalState: setGlobalState,\n                          onGlobalStateChange: onGlobalStateChange\n                        })));\n                      case 1:\n                      case \"end\":\n                        return _context7.stop();\n                    }\n                  }, _callee7);\n                }));\n                return function (_x4) {\n                  return _ref7.apply(this, arguments);\n                };\n              }(),\n              /*#__PURE__*/\n              // finish loading after app mounted\n              _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n                return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n                  while (1) switch (_context8.prev = _context8.next) {\n                    case 0:\n                      return _context8.abrupt(\"return\", render({\n                        element: appWrapperElement,\n                        loading: false,\n                        container: remountContainer\n                      }, 'mounted'));\n                    case 1:\n                    case \"end\":\n                      return _context8.stop();\n                  }\n                }, _callee8);\n              })), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n                return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n                  while (1) switch (_context9.prev = _context9.next) {\n                    case 0:\n                      return _context9.abrupt(\"return\", execHooksChain(toArray(afterMount), app, global));\n                    case 1:\n                    case \"end\":\n                      return _context9.stop();\n                  }\n                }, _callee9);\n              })),\n              /*#__PURE__*/\n              // initialize the unmount defer after app mounted and resolve the defer after it unmounted\n              _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n                return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n                  while (1) switch (_context10.prev = _context10.next) {\n                    case 0:\n                      _context10.next = 2;\n                      return validateSingularMode(singular, app);\n                    case 2:\n                      if (!_context10.sent) {\n                        _context10.next = 4;\n                        break;\n                      }\n                      prevAppUnmountedDeferred = new Deferred();\n                    case 4:\n                    case \"end\":\n                      return _context10.stop();\n                  }\n                }, _callee10);\n              })), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11() {\n                var measureName;\n                return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n                  while (1) switch (_context11.prev = _context11.next) {\n                    case 0:\n                      if (process.env.NODE_ENV === 'development') {\n                        measureName = \"[qiankun] App \".concat(appInstanceId, \" Loading Consuming\");\n                        performanceMeasure(measureName, markName);\n                      }\n                    case 1:\n                    case \"end\":\n                      return _context11.stop();\n                  }\n                }, _callee11);\n              }))],\n              unmount: [/*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12() {\n                return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n                  while (1) switch (_context12.prev = _context12.next) {\n                    case 0:\n                      return _context12.abrupt(\"return\", execHooksChain(toArray(beforeUnmount), app, global));\n                    case 1:\n                    case \"end\":\n                      return _context12.stop();\n                  }\n                }, _callee12);\n              })), /*#__PURE__*/function () {\n                var _ref13 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13(props) {\n                  return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n                    while (1) switch (_context13.prev = _context13.next) {\n                      case 0:\n                        return _context13.abrupt(\"return\", unmount(_objectSpread(_objectSpread({}, props), {}, {\n                          container: appWrapperGetter()\n                        })));\n                      case 1:\n                      case \"end\":\n                        return _context13.stop();\n                    }\n                  }, _callee13);\n                }));\n                return function (_x5) {\n                  return _ref13.apply(this, arguments);\n                };\n              }(), unmountSandbox, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee14() {\n                return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n                  while (1) switch (_context14.prev = _context14.next) {\n                    case 0:\n                      return _context14.abrupt(\"return\", execHooksChain(toArray(afterUnmount), app, global));\n                    case 1:\n                    case \"end\":\n                      return _context14.stop();\n                  }\n                }, _callee14);\n              })), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee15() {\n                return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n                  while (1) switch (_context15.prev = _context15.next) {\n                    case 0:\n                      render({\n                        element: null,\n                        loading: false,\n                        container: remountContainer\n                      }, 'unmounted');\n                      offGlobalStateChange(appInstanceId);\n                      // for gc\n                      appWrapperElement = null;\n                      syncAppWrapperElement2Sandbox(appWrapperElement);\n                    case 4:\n                    case \"end\":\n                      return _context15.stop();\n                  }\n                }, _callee15);\n              })), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee16() {\n                return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n                  while (1) switch (_context16.prev = _context16.next) {\n                    case 0:\n                      _context16.next = 2;\n                      return validateSingularMode(singular, app);\n                    case 2:\n                      _context16.t0 = _context16.sent;\n                      if (!_context16.t0) {\n                        _context16.next = 5;\n                        break;\n                      }\n                      _context16.t0 = prevAppUnmountedDeferred;\n                    case 5:\n                      if (!_context16.t0) {\n                        _context16.next = 7;\n                        break;\n                      }\n                      prevAppUnmountedDeferred.resolve();\n                    case 7:\n                    case \"end\":\n                      return _context16.stop();\n                  }\n                }, _callee16);\n              }))]\n            };\n            if (typeof update === 'function') {\n              parcelConfig.update = update;\n            }\n            return parcelConfig;\n          };\n          return _context17.abrupt(\"return\", parcelConfigGetter);\n        case 48:\n        case \"end\":\n          return _context17.stop();\n      }\n    }, _callee17);\n  }));\n  return _loadApp.apply(this, arguments);\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}