{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\n/**\n * @author Kuitos\n * @homepage https://github.com/kuitos/\n * @since 2019-02-25\n * fork from https://github.com/systemjs/systemjs/blob/master/src/extras/global.js\n */\n\nvar isIE11 = typeof navigator !== 'undefined' && navigator.userAgent.indexOf('Trident') !== -1;\nfunction shouldSkipProperty(global, p) {\n  if (!global.hasOwnProperty(p) || !isNaN(p) && p < global.length) return true;\n  if (isIE11) {\n    // https://github.com/kuitos/import-html-entry/pull/32，最小化 try 范围\n    try {\n      return global[p] && typeof window !== 'undefined' && global[p].parent === window;\n    } catch (err) {\n      return true;\n    }\n  } else {\n    return false;\n  }\n}\n\n// safari unpredictably lists some new globals first or second in object order\nvar firstGlobalProp, secondGlobalProp, lastGlobalProp;\nexport function getGlobalProp(global) {\n  var cnt = 0;\n  var lastProp;\n  var hasIframe = false;\n  for (var p in global) {\n    if (shouldSkipProperty(global, p)) continue;\n\n    // 遍历 iframe，检查 window 上的属性值是否是 iframe，是则跳过后面的 first 和 second 判断\n    for (var i = 0; i < window.frames.length && !hasIframe; i++) {\n      var frame = window.frames[i];\n      if (frame === global[p]) {\n        hasIframe = true;\n        break;\n      }\n    }\n    if (!hasIframe && (cnt === 0 && p !== firstGlobalProp || cnt === 1 && p !== secondGlobalProp)) return p;\n    cnt++;\n    lastProp = p;\n  }\n  if (lastProp !== lastGlobalProp) return lastProp;\n}\nexport function noteGlobalProps(global) {\n  // alternatively Object.keys(global).pop()\n  // but this may be faster (pending benchmarks)\n  firstGlobalProp = secondGlobalProp = undefined;\n  for (var p in global) {\n    if (shouldSkipProperty(global, p)) continue;\n    if (!firstGlobalProp) firstGlobalProp = p;else if (!secondGlobalProp) secondGlobalProp = p;\n    lastGlobalProp = p;\n  }\n  return lastGlobalProp;\n}\nexport function getInlineCode(match) {\n  var start = match.indexOf('>') + 1;\n  var end = match.lastIndexOf('<');\n  return match.substring(start, end);\n}\nexport function defaultGetPublicPath(entry) {\n  if (_typeof(entry) === 'object') {\n    return '/';\n  }\n  try {\n    var _URL = new URL(entry, location.href),\n      origin = _URL.origin,\n      pathname = _URL.pathname;\n    var paths = pathname.split('/');\n    // 移除最后一个元素\n    paths.pop();\n    return \"\".concat(origin).concat(paths.join('/'), \"/\");\n  } catch (e) {\n    console.warn(e);\n    return '';\n  }\n}\n\n// Detect whether browser supports `<script type=module>` or not\nexport function isModuleScriptSupported() {\n  var s = document.createElement('script');\n  return 'noModule' in s;\n}\n\n// RIC and shim for browsers setTimeout() without it\nexport var requestIdleCallback = window.requestIdleCallback || function requestIdleCallback(cb) {\n  var start = Date.now();\n  return setTimeout(function () {\n    cb({\n      didTimeout: false,\n      timeRemaining: function timeRemaining() {\n        return Math.max(0, 50 - (Date.now() - start));\n      }\n    });\n  }, 1);\n};\nexport function readResAsString(response, autoDetectCharset) {\n  // 未启用自动检测\n  if (!autoDetectCharset) {\n    return response.text();\n  }\n\n  // 如果没headers，发生在test环境下的mock数据，为兼容原有测试用例\n  if (!response.headers) {\n    return response.text();\n  }\n\n  // 如果没返回content-type，走默认逻辑\n  var contentType = response.headers.get('Content-Type');\n  if (!contentType) {\n    return response.text();\n  }\n\n  // 解析content-type内的charset\n  // Content-Type: text/html; charset=utf-8\n  // Content-Type: multipart/form-data; boundary=something\n  // GET请求下不会出现第二种content-type\n  var charset = 'utf-8';\n  var parts = contentType.split(';');\n  if (parts.length === 2) {\n    var _parts$1$split = parts[1].split('='),\n      _parts$1$split2 = _slicedToArray(_parts$1$split, 2),\n      value = _parts$1$split2[1];\n    var encoding = value && value.trim();\n    if (encoding) {\n      charset = encoding;\n    }\n  }\n\n  // 如果还是utf-8，那么走默认，兼容原有逻辑，这段代码删除也应该工作\n  if (charset.toUpperCase() === 'UTF-8') {\n    return response.text();\n  }\n\n  // 走流读取，编码可能是gbk，gb2312等，比如sofa 3默认是gbk编码\n  return response.blob().then(function (file) {\n    return new Promise(function (resolve, reject) {\n      var reader = new window.FileReader();\n      reader.onload = function () {\n        resolve(reader.result);\n      };\n      reader.onerror = reject;\n      reader.readAsText(file, charset);\n    });\n  });\n}\nvar evalCache = {};\nexport function evalCode(scriptSrc, code) {\n  var key = scriptSrc;\n  if (!evalCache[key]) {\n    var functionWrappedCode = \"(function(){\".concat(code, \"})\");\n    evalCache[key] = (0, eval)(functionWrappedCode);\n  }\n  var evalFunc = evalCache[key];\n  evalFunc.call(window);\n}\n\n// 转换 url 中的转义字符，例如 &amp; => &\nexport function parseUrl(url) {\n  var parser = new DOMParser();\n  var html = \"<script src=\\\"\".concat(url, \"\\\"></script>\");\n  var doc = parser.parseFromString(html, \"text/html\");\n  return doc.scripts[0].src;\n}","map":{"version":3,"names":["_slicedToArray","_typeof","isIE11","navigator","userAgent","indexOf","shouldSkipProperty","global","p","hasOwnProperty","isNaN","length","window","parent","err","firstGlobalProp","secondGlobalProp","lastGlobalProp","getGlobalProp","cnt","lastProp","hasIframe","i","frames","frame","noteGlobalProps","undefined","getInlineCode","match","start","end","lastIndexOf","substring","defaultGetPublicPath","entry","_URL","URL","location","href","origin","pathname","paths","split","pop","concat","join","e","console","warn","isModuleScriptSupported","s","document","createElement","requestIdleCallback","cb","Date","now","setTimeout","didTimeout","timeRemaining","Math","max","readResAsString","response","autoDetectCharset","text","headers","contentType","get","charset","parts","_parts$1$split","_parts$1$split2","value","encoding","trim","toUpperCase","blob","then","file","Promise","resolve","reject","reader","FileReader","onload","result","onerror","readAsText","evalCache","evalCode","scriptSrc","code","key","functionWrappedCode","eval","evalFunc","call","parseUrl","url","parser","DOMParser","html","doc","parseFromString","scripts","src"],"sources":["/home/lishu/桌面/Micro_frontend_practice/qiankun_micro/qiankun-base/node_modules/import-html-entry/esm/utils.js"],"sourcesContent":["import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\n/**\n * @author Kuitos\n * @homepage https://github.com/kuitos/\n * @since 2019-02-25\n * fork from https://github.com/systemjs/systemjs/blob/master/src/extras/global.js\n */\n\nvar isIE11 = typeof navigator !== 'undefined' && navigator.userAgent.indexOf('Trident') !== -1;\nfunction shouldSkipProperty(global, p) {\n  if (!global.hasOwnProperty(p) || !isNaN(p) && p < global.length) return true;\n  if (isIE11) {\n    // https://github.com/kuitos/import-html-entry/pull/32，最小化 try 范围\n    try {\n      return global[p] && typeof window !== 'undefined' && global[p].parent === window;\n    } catch (err) {\n      return true;\n    }\n  } else {\n    return false;\n  }\n}\n\n// safari unpredictably lists some new globals first or second in object order\nvar firstGlobalProp, secondGlobalProp, lastGlobalProp;\nexport function getGlobalProp(global) {\n  var cnt = 0;\n  var lastProp;\n  var hasIframe = false;\n  for (var p in global) {\n    if (shouldSkipProperty(global, p)) continue;\n\n    // 遍历 iframe，检查 window 上的属性值是否是 iframe，是则跳过后面的 first 和 second 判断\n    for (var i = 0; i < window.frames.length && !hasIframe; i++) {\n      var frame = window.frames[i];\n      if (frame === global[p]) {\n        hasIframe = true;\n        break;\n      }\n    }\n    if (!hasIframe && (cnt === 0 && p !== firstGlobalProp || cnt === 1 && p !== secondGlobalProp)) return p;\n    cnt++;\n    lastProp = p;\n  }\n  if (lastProp !== lastGlobalProp) return lastProp;\n}\nexport function noteGlobalProps(global) {\n  // alternatively Object.keys(global).pop()\n  // but this may be faster (pending benchmarks)\n  firstGlobalProp = secondGlobalProp = undefined;\n  for (var p in global) {\n    if (shouldSkipProperty(global, p)) continue;\n    if (!firstGlobalProp) firstGlobalProp = p;else if (!secondGlobalProp) secondGlobalProp = p;\n    lastGlobalProp = p;\n  }\n  return lastGlobalProp;\n}\nexport function getInlineCode(match) {\n  var start = match.indexOf('>') + 1;\n  var end = match.lastIndexOf('<');\n  return match.substring(start, end);\n}\nexport function defaultGetPublicPath(entry) {\n  if (_typeof(entry) === 'object') {\n    return '/';\n  }\n  try {\n    var _URL = new URL(entry, location.href),\n      origin = _URL.origin,\n      pathname = _URL.pathname;\n    var paths = pathname.split('/');\n    // 移除最后一个元素\n    paths.pop();\n    return \"\".concat(origin).concat(paths.join('/'), \"/\");\n  } catch (e) {\n    console.warn(e);\n    return '';\n  }\n}\n\n// Detect whether browser supports `<script type=module>` or not\nexport function isModuleScriptSupported() {\n  var s = document.createElement('script');\n  return 'noModule' in s;\n}\n\n// RIC and shim for browsers setTimeout() without it\nexport var requestIdleCallback = window.requestIdleCallback || function requestIdleCallback(cb) {\n  var start = Date.now();\n  return setTimeout(function () {\n    cb({\n      didTimeout: false,\n      timeRemaining: function timeRemaining() {\n        return Math.max(0, 50 - (Date.now() - start));\n      }\n    });\n  }, 1);\n};\nexport function readResAsString(response, autoDetectCharset) {\n  // 未启用自动检测\n  if (!autoDetectCharset) {\n    return response.text();\n  }\n\n  // 如果没headers，发生在test环境下的mock数据，为兼容原有测试用例\n  if (!response.headers) {\n    return response.text();\n  }\n\n  // 如果没返回content-type，走默认逻辑\n  var contentType = response.headers.get('Content-Type');\n  if (!contentType) {\n    return response.text();\n  }\n\n  // 解析content-type内的charset\n  // Content-Type: text/html; charset=utf-8\n  // Content-Type: multipart/form-data; boundary=something\n  // GET请求下不会出现第二种content-type\n  var charset = 'utf-8';\n  var parts = contentType.split(';');\n  if (parts.length === 2) {\n    var _parts$1$split = parts[1].split('='),\n      _parts$1$split2 = _slicedToArray(_parts$1$split, 2),\n      value = _parts$1$split2[1];\n    var encoding = value && value.trim();\n    if (encoding) {\n      charset = encoding;\n    }\n  }\n\n  // 如果还是utf-8，那么走默认，兼容原有逻辑，这段代码删除也应该工作\n  if (charset.toUpperCase() === 'UTF-8') {\n    return response.text();\n  }\n\n  // 走流读取，编码可能是gbk，gb2312等，比如sofa 3默认是gbk编码\n  return response.blob().then(function (file) {\n    return new Promise(function (resolve, reject) {\n      var reader = new window.FileReader();\n      reader.onload = function () {\n        resolve(reader.result);\n      };\n      reader.onerror = reject;\n      reader.readAsText(file, charset);\n    });\n  });\n}\nvar evalCache = {};\nexport function evalCode(scriptSrc, code) {\n  var key = scriptSrc;\n  if (!evalCache[key]) {\n    var functionWrappedCode = \"(function(){\".concat(code, \"})\");\n    evalCache[key] = (0, eval)(functionWrappedCode);\n  }\n  var evalFunc = evalCache[key];\n  evalFunc.call(window);\n}\n\n// 转换 url 中的转义字符，例如 &amp; => &\nexport function parseUrl(url) {\n  var parser = new DOMParser();\n  var html = \"<script src=\\\"\".concat(url, \"\\\"></script>\");\n  var doc = parser.parseFromString(html, \"text/html\");\n  return doc.scripts[0].src;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}